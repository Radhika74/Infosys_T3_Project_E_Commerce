<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Delivery Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/delivery.css') }}">
</head>
<body>
    <h2 class="title">Delivery Dashboard</h2>

    <div class="container">
        <!-- New Orders Section -->
        <div class="section">
            <h3>New Orders</h3>
            {% if new_orders %}
                <table>
                    <tr>
                        <th>Order ID</th>
                        <th>Customer Name</th>
                        <th>Product</th>
                        <th>Action</th>
                    </tr>
                    {% for order in new_orders %}
                    <tr>
                        <td>{{ order.id }}</td>
                        <td>{{ order.customer_name }}</td>
                        <td>{{ order.product_name }}</td>
                        <td>
                            <a href="{{ url_for('delivery.assign_delivery', order_id=order.id, person_id = person.id ) }}">
                                <button class="btn btn-update-status" type="button">Assign Me</button>
                            </a>
                        </td>
                        
                        <!-- <td><button class="assign-btn">Assign</button></td> -->
                    </tr>
                    {% endfor %}
                </table>
            {% else %}
                <p class="empty">No new orders available for delivery</p>
            {% endif %}
        </div>

        <!-- Assigned Orders Section -->
        <div class="section">
            <h3>Assigned Orders</h3>
            {% if assigned_orders %}
                <table>
                    <tr>
                        <th>Order ID</th>
                        <th>Customer Name</th>
                        <th>Product</th>
                        <th>Status</th>
                        <th>Action</th>
                    </tr>
                    {% for order in assigned_orders %}
                    <tr>
                        <td>{{ order.id }}</td>
                        <td>{{ order.customer_name }}</td>
                        <td>{{ order.product_name }}</td>
                        <td>{{ order.delivery_status }}</td>
                        <td>
                            <select id="statusSelect">
                                <option value="In Transit" {% if order.status == "In Transit" %}selected{% endif %}>In Transit</option>
                                <option value="accepted">accepted</option>
                                <option value="pending">pending</option>
                                <option value="Delivered">Delivered</option>
                            </select>
                            <a href="{{ url_for('delivery.update_status', order_id=order.id, status='PLACEHOLDER') }}" id="updateStatusLink">
                                <button class="btn btn-update-status">Update Status</button>
                            </a>
                            
                        </td>
                    </tr>
                    {% endfor %}
                    <script>
                        document.getElementById('statusSelect').addEventListener('change', function() {
                            document.getElementById('updateStatusLink').href = "{{ url_for('delivery.update_status', order_id=order.id, status='PLACEHOLDER') }}".replace('PLACEHOLDER', this.value);
                            console.log(`this.value  :  ${this.value}`)
                        });
                        document.getElementById('updateStatusLink').href = "{{ url_for('delivery.update_status', order_id=order.id, status='PLACEHOLDER') }}".replace('PLACEHOLDER', document.getElementById('statusSelect').value);
                
                        console.log(`document.getElementById('statusSelect').value   :  ${document.getElementById('statusSelect').value}`)
                    </script>
                </table>
            {% else %}
                <p class="empty">No assigned orders</p>
            {% endif %}
        </div>

        <!-- Delivered Orders Section -->
        <div class="section">
            <h3>Delivered Orders</h3>
            {% if delivered_orders %}
                <table>
                    <tr>
                        <th>Order ID</th>
                        <th>Customer Name</th>
                        <th>Product</th>
                        <th>Status</th>
                    </tr>
                    {% for order in delivered_orders %}
                    <tr>
                        <td>{{ order.id }}</td>
                        <td>{{ order.customer_name }}</td>
                        <td>{{ order.product }}</td>
                        <td>{{ order.status }}</td>
                    </tr>
                    {% endfor %}
                </table>
            {% else %}
                <p class="empty">No delivered orders</p>
            {% endif %}
        </div>
    </div>

    
    
    



</body>
</html>
